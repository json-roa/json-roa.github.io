<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta content='width=device-width, initial-scale=1' name='viewport'>
    <title>JSON-ROA (Beta)</title>
    <link href="/stylesheets/app-dcff9da2.css" rel="stylesheet" type="text/css" />
    <script src="/javascripts/app-eca7008a.js" type="text/javascript"></script>
  </head>
  <body class='specification'>
    <div class='container'>
      <nav class='navbar navbar-default' role='navigation'>
        <div class='navbar-header'>
          <a class='navbar-brand' href='index.html'>
            JSON-ROA
            <em>(BETA)</em>
          </a>
        </div>
        <div class='navbar-collapse collapse'>
          <ul class='nav navbar-nav'>
            <li>
              <a href='specification.html'>Specification</a>
            </li>
            <li>
              <a href='/browser/index.html'>The JSON-ROA Browser</a>
            </li>
          </ul>
        </div>
      </nav>
      
      <h1 id="specification-and-interpretation">Specification and Interpretation</h1>
      
      <p>This is an informal specification of the JSON-ROA extension and
      how clients should interpret and use it.</p>
      
      <p>This specification is feature complete but not finished and may thus change at
      any time. Once finished JSON-ROA shall adapt semantic versioning.</p>
      
      <h2 id="the-content-type">The Content-Type</h2>
      
      <p>The JSON-ROA extension shall be present if and only of the
      resource is delivered with the content type <code>application/json-roa+json</code>.</p>
      
      <h2 id="the-json-roa-object">The JSON-ROA Object</h2>
      
      <div class="row">
        <div class="col-md-6">
      
          <p>A minimal valid JSON-ROA extension is introduced with <code>_json-roa</code>. It
      must contain the key <code>version</code> where the value must be formatted
      according to <a href="http://semver.org/">Semantic Versioning</a>.</p>
      
          <p>It may further contain the keys <code>relations</code>, <code>collection</code>, <code>name</code>, and
      <code>self-relation</code>. See the <a href="#the-relations-object">relations object</a>, the <a href="#the-collection-object">collection object</a>,
      and the <a href="#the-relation-object">relation object</a> for the specification of the corresponding
      values.</p>
      
        </div>
        <div class="col-md-6">
      
          <pre><code>{ "_json-roa": { "version" : "0.0.0-beta.0+20141126" }
        , "x": "some other data"
        , "y": 42
        , "z": false }
      </code></pre>
      
        </div>
      </div>
      
      <h3 id="the-relations-object">The Relations Object</h3>
      
      <div class="row">
        <div class="col-md-6">
      
          <p>Relations is an object where the keys are <em>relation-identifiers</em> and each
      corresponding value is a <a href="#the-relation-object">relation object</a>.</p>
      
        </div>
        <div class="col-md-6">
      
          <pre><code>{ "_json-roa":
        { "version" : "0.0.0-beta.0+20141126"
        , "relations": 
            { "t42" : 
              { "href" : "/task/42"} }}}
      </code></pre>
      
        </div>
      </div>
      
      <h3 id="the-relation-identifier">The Relation Identifier</h3>
      
      <div class="row">
        <div class="col-md-6">
      
          <p>The <strong>identifier of a relation</strong> is meant to be used in clients to dereference
      the relation object and in particular use the <code>href</code>-value within. </p>
      
          <p>The example is taken from working with the <a href="https://github.com/json-roa/json-roa_ruby-client">JSON-ROA Ruby Client</a>. A
      resource <code>execution</code> has a relation with the identifier <code>tasks</code> which is
      used to perform an http GET request on URL given by the href-value.</p>
      
        </div>
        <div class="col-md-6">
          <pre><code>execution.relation('tasks').get()
      </code></pre>
        </div>
      </div>
      
      <h3 id="the-relation-object">The Relation Object</h3>
      <div class="row">
        <div class="col-md-6">
      
          <p>A relation is an object which must contain the key <code>href</code>. It may
      contain the keys <code>embedded</code>,<code>name</code>, <code>methods</code>, and <code>relations</code>. See the
      section <a href="#meta-relations">Meta Relations</a> for the interpretation of <code>relations</code>. See
      the section <a href="#embedding-resources">Embedding Resources</a> for usage and interpretation of
      <code>embedded</code>.</p>
      
        </div>
        <div class="col-md-6">
          <pre><code>{ "name": "Tasks"
        "href": "/tasks/" }
      </code></pre>
        </div>
      </div>
      
      <h3 id="the-href-value">The Href Value</h3>
      <div class="row">
        <div class="col-md-6">
      
          <p>The value of <code>href</code> is a string and represents an URI according to
      <a href="https://tools.ietf.org/html/rfc3986">RFC3986 Uniform Resource Identifier</a>. It must at least contain a path
      segment. The values before the path segment are inferred form the
      current resource if not given. The URI may be templated according to
      <a href="https://tools.ietf.org/html/rfc6570">RFC6570 URI Template</a>.</p>
      
        </div>
        <div class="col-md-6">
      
          <pre><code class="language-uri">http://some-service.com/tasks/ 
      
      /task/{id}
      </code></pre>
        </div>
      </div>
      
      <h4 id="context-and-interpretation-of-the-name-value">Context and Interpretation of the Name Value</h4>
      <div class="row">
        <div class="col-md-6">
      
          <p>The name should not be used for technical purposes. 
      The name is used, e.g. by <a href="">The JSON-ROA Browser</a> to give a readable and
      understandable output for the human user. </p>
        </div>
      </div>
      
      <h3 id="the-methods-object">The Methods Object</h3>
      <div class="row">
        <div class="col-md-6">
      
          <p>The methods object may contain the keys <code>get</code>, <code>put</code>, <code>patch</code>, <code>post</code>, and <code>delete</code>. 
      Each value is an empty object at this time. </p>
      
          <p>Clients should interpret the available HTTP-method to act on the
      given url respectively resource they address. </p>
      
          <p>If the no <code>methods</code> are  given, clients should assume that 
      <code>get</code> and only <code>get</code> is available. </p>
      
        </div>
        <div class="col-md-6">
      
          <pre><code class="language-json">{ "name": "Tasks"
      , "href": "/tasks/" 
      , "methods": 
        { "get": {} 
        , "post": {}}}
      
      { "methods": 
        { "get": {} }}
      </code></pre>
      
        </div>
      </div>
      
      <h4 id="meta-relations">Meta Relations</h4>
      <div class="row">
        <div class="col-md-6">
      
          <p>Relations of a Relation will often make little sense from an application
      viewpoint. There are other mentionable use cases. The first is finding
      documentation for humans. </p>
      
        </div>
      </div>
      
      <h3 id="the-collection-object">The Collection Object</h3>
      <div class="row">
        <div class="col-md-6">
      
          <p>The <em>collection</em> object semantically links to a number 
      of structurally equivalent resources. Conventionally
      only url paths ending with a slash will, e.g. <code>/tasks/</code>
      will contain a collection.</p>
      
          <p>The collection object must contain a <code>relations</code> key 
      which contains a <a href="#relations">relations</a> as described. 
      It is suggested to use integers as keys which represent 
      the index of the given link within the collection.</p>
      
          <p>The collection can contain a <code>next</code> key with the value of a <a href="#the-relation-object">relation
      object</a> with the following restriction: the included url may not be
      templated. Clients use <code>next</code> to iterate of a paginated collection. API
      providers should keep the search parameters between successive next link
      (with the exception of the parameter used for pagination if present).</p>
      
          <p>Any of the following to conditions signals the end of the 
      iteration for a client: </p>
      
          <ol>
            <li>The relations object is empty. </li>
            <li>There is no next key respectively object.</li>
          </ol>
      
        </div>
        <div class="col-md-6">
          <pre><code>"collection": {
          "next": {
            "href": "/tasks/?page=1"
          },
          "relations": {
            "1": {
              "name": "Task",
              "href": "/task/6d5033f4-768f-55af-8efe-11e563f4af93"
            },
            "2": {
              "name": "Task",
              "href": "/task/2a8f061f-26dc-5b41-af9c-84f9ba54679a"
            },
      </code></pre>
        </div>
      </div>
      
      <h3 id="embedding-resources">Embedding Resources</h3>
      
      <div class="row">
        <div class="col-md-6">
          <p class="text-warning">Embedding resources is an experimental proposal. There does
      not exist any implementation or proof of concept at this time.</p>
      
          <p>A <a href="#the-relation-object">relation object</a> can contain the key <code>embedded</code>. The corresponding
      value must be equal to the to JSON transformed response body given by
      requesting the resource with http get and receiving the representation
      of content-type <code>application/json-roa+json</code>. Some restrictions apply:</p>
      
          <ol>
            <li>
              <p>The <code>href</code> value of the relation must not be a template url.  </p>
            </li>
            <li>
              <p>The http get method must be applicable to the resource. </p>
            </li>
          </ol>
      
          <p>Handling of embedded resources must be completely transparent. I.e. 
      clients must not depend on the existence of an embedded object. On 
      the other hand are clients not required to honor <code>embedded</code> 
      resources.</p>
      
          <p>JSON-ROA does not define any technique how to negotiate respectively 
      request embeddings. This is application and context dependent. A 
      custom HTTP header seems to be appropriate for many cases. </p>
      
        </div>
        <div class="col-md-6"></div>
      </div>
      
      <div class="row">
        <div class="col-md-6"></div>
        <div class="col-md-6"></div>
      </div>
    </div>
  </body>
</html>
